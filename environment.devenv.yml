#
# Conda devenv environment for pado_visualize.
#
# Create the environment, do not install pado_visualize in development mode:
#   conda devenv
# equivalent to:
#   PADO_VISUALIZE_DEVEL="" conda devenv
# Create the environment, install pado in development mode:
#   PADO_VISUALIZE_DEVEL=TRUE conda devenv
#

{% set PADO_VISUALIZE_DEVEL = os.environ.get('PADO_VISUALIZE_DEVEL', False) %}

name: pado_visualize

channels:
  - conda-forge

dependencies:
  - python=3.9  # let's not carry the 3.6, 3.7, 3.8 baggage for now
  - pip

  # dev related
  - nodejs=16.*  # revisit when upgrading js deps
  - pre-commit
  - pytest
  - pytest-cov
  - mypy
  - supervisor

  # webapp related
  - celery
  - click
  - diskcache
  - dynaconf
  - filelock
  - flask>=2
  - flask-caching>=1.8.0
  - flask-dance
  - flower
  - redis-py
  - werkzeug
  - pyopenssl

  # data deps
  - numpy
  - pandas
  - rasterio

  # tiffslide deps
  - fsspec
  - imagecodecs
  - pillow
  - tifffile>=2020.10.1
  - zarr

  # pado deps
  - platformdirs
  - orjson
  - toml
  - pyarrow
  - shapely
  - pydantic
  - geojson-pydantic

  # utils
  - tqdm
  - s3fs
  - typer

  - geopandas
  - uwsgi

  # fixme: this should be removed as soon as hd1a6beb_1008 is not the newest version anymore
  - gettext=0.19.8.1=hd1a6beb_1007  # [ osx ]
  - gettext  # [ not osx ]

  - pip:
    # homemade dependencies
    - tiffslide
    - git+ssh://git@github.com/bayer-science-for-a-better-life/pado.git#egg=pado  # [ not PADO_VISUALIZE_DEVEL ]
    - "-e ."  # [ PADO_VISUALIZE_DEVEL ]
